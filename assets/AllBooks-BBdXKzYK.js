import{D as L,o as j,r as n,G as P,I as v,j as a,m as y,A as F,C as E}from"./index-DpF_DXXf.js";import{V as T}from"./VoiceSearchButton-D2XXZ_Ty.js";function $(){const l=L(),{books:x,totalBooks:u}=j(e=>e.books),[g,h]=n.useState(""),[s,o]=n.useState(1),[b]=n.useState(8),[d,c]=n.useState({genre:[],minRating:0,author:"",year:"",sortBy:"latest"}),[p,f]=n.useState(!1),i=j(e=>e.auth.user),N=()=>{c({genre:[],minRating:0,author:"",year:"",sortBy:"latest"}),h(""),o(1)},k=e=>{h(e),o(1),c(t=>({...t,genre:[],minRating:0}))},C=e=>{k(e)},w=e=>{h(""),o(1),c(t=>({...t,genre:t.genre.includes(e)?t.genre.filter(r=>r!==e):[...t.genre,e]}))},S=e=>{h(""),o(1),c(t=>({...t,minRating:t.minRating===e?0:e}))},R=e=>{c(t=>({...t,sortBy:e})),o(1)},m=e=>{o(e),window.scrollTo({top:0,behavior:"smooth"})};n.useLayoutEffect(()=>{f(!0),l(P({page:s,filters:d,searchQuery:g})).finally(()=>{f(!1)})},[s,d,g,l]),n.useLayoutEffect(()=>{i!=null&&i.id&&l(v(i.id))},[i==null?void 0:i.id,l]);const A={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.05}}},B={hidden:{opacity:0,y:10},show:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:15,duration:.3}}};return a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 mt-16",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8 space-y-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm",children:[a.jsxs("div",{className:"relative flex items-center",children:[a.jsx("input",{type:"text",value:g,placeholder:"Search books...",onChange:e=>k(e.target.value),className:"w-full px-4 py-2 rounded-lg border dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100"}),a.jsx(T,{onSearch:C})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Action","Romance","Comedy","Fantasy","Slice of Life"].map(e=>a.jsx("button",{onClick:()=>w(e),className:`px-4 py-2 rounded-full ${d.genre.includes(e)?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:e},e)),(d.genre.length>0||d.minRating>0||g)&&a.jsx("button",{onClick:N,className:"px-4 py-2 rounded-full bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 hover:bg-red-200 dark:hover:bg-red-900/50",children:"Clear Filters"})]}),a.jsxs("div",{className:"flex items-center gap-4 text-gray-700 dark:text-gray-300",children:[a.jsx("span",{children:"Minimum Rating:"}),[1,2,3,4,5].map(e=>a.jsx("button",{onClick:()=>S(e),className:`p-2 ${d.minRating===e?"text-yellow-500":"text-gray-400 dark:text-gray-600"}`,children:"⭐"},e))]}),a.jsxs("select",{onChange:e=>R(e.target.value),className:"px-4 py-2 rounded-lg border dark:border-gray-700 dark:bg-gray-700 dark:text-gray-100",children:[a.jsx("option",{value:"latest",children:"Latest"}),a.jsx("option",{value:"rating",children:"Highest Rated"}),a.jsx("option",{value:"title",children:"Title A-Z"})]})]}),!p&&x.length===0&&a.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-8",children:a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No books found. Try adjusting your filters or search terms."})}),a.jsx(y.div,{variants:A,initial:"hidden",animate:"show",className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mb-8",children:a.jsx(F,{mode:"popLayout",children:x.map((e,t)=>a.jsx(y.div,{variants:B,layout:!0,initial:"hidden",animate:"show",exit:{opacity:0,y:-10},children:a.jsx(E,{book:e,index:t,onFavoriteToggle:()=>{i!=null&&i.id&&l(v(i.id))}})},e.id))})}),!p&&x.length>0&&a.jsxs("div",{className:"flex justify-center items-center space-x-2 py-4",children:[a.jsx("button",{onClick:()=>m(s-1),disabled:s===1,className:"px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Previous"}),a.jsx("div",{className:"flex space-x-2",children:(()=>{const e=Math.ceil(u/b),t=[];for(let r=1;r<=e;r++)r===1||r===e||r>=s-1&&r<=s+1?t.push(a.jsx("button",{onClick:()=>m(r),className:`px-4 py-2 rounded-lg ${s===r?"bg-blue-500 text-white":"border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800"}`,children:r},r)):(r===s-2&&s>3||r===s+2&&s<e-2)&&t.push(a.jsx("span",{className:"px-2 text-gray-500 dark:text-gray-400 self-end",children:"..."},r));return t})()}),a.jsx("button",{onClick:()=>m(s+1),disabled:s>=Math.ceil(u/b),className:"px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Next"})]}),p&&a.jsx("div",{className:"flex justify-center p-4",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})]})})}export{$ as default};
